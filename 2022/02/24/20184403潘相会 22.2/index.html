

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="Abstract如果可以识别出一张证件照片的证件主体部分并矫正，不仅可以方便信息的读取，还能减少图片的储存空间。不仅如此，若配合机器识别技术，可以大幅提高识别证件信息的效率。在传统的知识基础上，我们还提出了“区分度”的概念，这在整个过程中起到了非常关键的作用；在直线拟合的步骤中，我们在最小二乘法拟合的基础上引入“关键点拟合”的方法，提高了直线拟合的精确率。实验证明该算法得到的结果精确度很高，可以识">
<meta property="og:type" content="article">
<meta property="og:title" content="22.2.24">
<meta property="og:url" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/index.html">
<meta property="og:site_name" content="Befine">
<meta property="og:description" content="Abstract如果可以识别出一张证件照片的证件主体部分并矫正，不仅可以方便信息的读取，还能减少图片的储存空间。不仅如此，若配合机器识别技术，可以大幅提高识别证件信息的效率。在传统的知识基础上，我们还提出了“区分度”的概念，这在整个过程中起到了非常关键的作用；在直线拟合的步骤中，我们在最小二乘法拟合的基础上引入“关键点拟合”的方法，提高了直线拟合的精确率。实验证明该算法得到的结果精确度很高，可以识">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist1.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist2.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist3.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist4.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/bc.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/%E5%B9%B3%E6%BB%91.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/test1.jpg">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/1.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/test6.jpg">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/2.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/direction.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case1.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case2.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case3.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/detect1%20(1).png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/detect2.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/intersactions.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/tz.png">
<meta property="og:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/关键点.png">
<meta property="article:published_time" content="2022-02-23T16:00:00.000Z">
<meta property="article:modified_time" content="2022-02-23T15:50:54.151Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist1.png">
  
  
  <title>22.2.24 - Befine</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>kyle</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="22.2.24">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-02-24 00:00" pubdate>
        February 24, 2022 am
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3.3k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      28 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">22.2.24</h1>
            
            <div class="markdown-body">
              <h3 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h3><p>如果可以识别出一张证件照片的证件主体部分并矫正，不仅可以方便信息的读取，还能减少图片的储存空间。不仅如此，若配合机器识别技术，可以大幅提高识别证件信息的效率。在传统的知识基础上，我们还提出了“区分度”的概念，这在整个过程中起到了非常关键的作用；在直线拟合的步骤中，我们在最小二乘法拟合的基础上引入“关键点拟合”的方法，提高了直线拟合的精确率。实验证明该算法得到的结果精确度很高，可以识别直线检测算法有时不能识别的边缘。</p>
<p><em>Keywords</em>:    证件边缘识别，矫正，区分度，关键点</p>
<h3 id="区分度的概念"><a href="#区分度的概念" class="headerlink" title="区分度的概念"></a>区分度的概念</h3><p>​        为了便于后续步骤的介绍，我们首先补充区分度的概念：在2*2的的像素块中，定义边的能量为相邻两像素点像素值差的绝对值。在四条边中，断开两条能量值最大的两条边，将四个像素点分为两个部分。显然，一个的部分中像素值较大，而另一个部分中像素值较小。取像素值较大的部分中最小的像素值与像素值较小部分中最大的像素值作差，得到区分度的值。区分度越大则该点越可能是图像中的边缘部分。</p>
<p>​        例如：</p>
<p>​        </p>
<table frame="void">    <!--使用table标签，且frame=void消除外边框-->
    <tr>           <!--<tr>一行的内容<\tr>，<td>一个格子的内容<\td>-->
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist1.png" srcset="/img/loading.gif" lazyload alt="第一张图片显示不出时显示的文字" height="150"></center></td>    <!--<center>标签将图片居中-->
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist2.png" srcset="/img/loading.gif" lazyload alt="第二张图片显示不出时显示的文字" height="150"></center></td>
    </tr>
</table>

<p>​        <em>特殊情况</em>：若四条边的能量相同，有以下两种情况：</p>
<table frame="void">    <!--使用table标签，且frame=void消除外边框-->
    <tr>           <!--<tr>一行的内容<\tr>，<td>一个格子的内容<\td>-->
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist3.png" srcset="/img/loading.gif" lazyload alt="第一张图片显示不出时显示的文字" height="150">    <!--<center>标签将图片居中-->
                     <br>
        (1)
                    </center></td>
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/dist4.png" srcset="/img/loading.gif" lazyload alt="第二张图片显示不出时显示的文字" height="150">
                    <br>
        (2)
                    </center></td>
    </tr>
</table>

<p>​    对于第一种情况，切断任意两条边得到的区分度均为0，符合实际情况。而对于第二种情况，使用排序算法得到能量最大的两条边，由于每条边能量大小相同，排序时不交换顺序，则得到的结果是第一、第二条边，计算区分度为0。然而考虑实际情况，这四个点应该是不属于一个区域的，区分度应该不等于0。为了避免类似的情况，我们补充：若得到的区分度小于5并且四个点中最大像素值减去最小像素值大于50，则将该点的区分度修改为后者。</p>
<h3 id="缩小图像"><a href="#缩小图像" class="headerlink" title="缩小图像"></a>缩小图像</h3><p>​        为了加快检测的速度，先对图像进行缩小操作。将图片的横向与纵向分别缩小为原来的1&#x2F;k,缩小的方法为将原图分为若干个k*k的像素块，取每个像素块的左上角点组成一个新的图像。缩小倍数k的选择依据原图的尺寸而定，对于正常手机拍摄的图片（大小在4000*3000像素左右），选取k&#x3D;25比较合适。</p>
<h3 id="预先处理"><a href="#预先处理" class="headerlink" title="预先处理"></a>预先处理</h3><h5 id="平滑"><a href="#平滑" class="headerlink" title="平滑"></a>平滑</h5><p>​        为了降低非边缘部分的区分度，从而凸显出证件边缘部分，我们预先对图像进行平滑操作。</p>
<p>​        具体算法为：</p>
<p>​    1. 如下定义步长为k的领域：对于中心点（i, j）,对于另外一点（x, y）,若max{|i-x|, |j - y|}  &#x3D; k,则该点在中心点      （i, j）以k为步长的邻域中。如图：</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/bc.png" srcset="/img/loading.gif" lazyload alt="bc" style="zoom:50%;">

<p>​        黑色点为中心点，红色点的集合为步长为1的邻域，黄色点的集合为步长为2的临域……</p>
<div class="code-wrapper"><pre><code class="hljs">    2. 从上到下、从左到右遍历图像，若中心点步长为k的邻域不超出图像的边界，则将所有邻域中的点与中心点像素值作差并取绝对值，将三个通道差值的和进行升序排序，取与中心点差值第二小的点的像素值给中心点重新赋值。修改时先用新的数组记录，赋值全部完成后统一修改。
      3. 确定一个最大步长max_k（2的指数），然后分别取步长为1,max_k, max_k/2, max_k/4,...1，最大步长越大，平滑的效果越明显，也更可能使得图像的边缘遭到破坏。经过实验发现最大步长取4即可有较好的效果。
</code></pre></div>
<p>平滑操作可以有效去除图像中的的噪声点，而对于图像的边缘则没有影响。</p>
<p>作图分析：</p>
<p>效果：</p>
<p><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/%E5%B9%B3%E6%BB%91.png" srcset="/img/loading.gif" lazyload alt="平滑"></p>
<h5 id="滤波"><a href="#滤波" class="headerlink" title="滤波"></a>滤波</h5><p>​        为了使得图像更加平滑，使用上述平滑操作后再使用参数为3中值滤波。源码调用了open cv的库函数。</p>
<h3 id="计算区分度"><a href="#计算区分度" class="headerlink" title="计算区分度"></a>计算区分度</h3><p>​        创建一个用于储存区分度的二维数组，每个点记录对应格子的三个通道区分度之和。</p>
<h3 id="获得证件边缘点"><a href="#获得证件边缘点" class="headerlink" title="获得证件边缘点"></a>获得证件边缘点</h3><p>​        经过平滑与滤波的操作，已经使得非证件边缘部分的分区度降低。取所有区分度前5%的点，可包含大部分证件边缘点。将这些点在edge数组中赋值为1，其余点赋值为0。</p>
<p>​        如：</p>
<table frame="void">    <!--使用table标签，且frame=void消除外边框-->
    <tr>           <!--<tr>一行的内容<\tr>，<td>一个格子的内容<\td>-->
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/test1.jpg" srcset="/img/loading.gif" lazyload alt="第一张图片显示不出时显示的文字" height="150">    <!--<center>标签将图片居中-->
                     <br>
        原图
                    </center></td>
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/1.png" srcset="/img/loading.gif" lazyload alt="第二张图片显示不出时显示的文字" height="150">
                    <br>
        结果
                    </center></td>
    </tr>
</table>

<table frame="void">    <!--使用table标签，且frame=void消除外边框-->
    <tr>           <!--<tr>一行的内容<\tr>，<td>一个格子的内容<\td>-->
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/test6.jpg" srcset="/img/loading.gif" lazyload alt="第一张图片显示不出时显示的文字" height="150">    <!--<center>标签将图片居中-->
                     <br>
        原图
                    </center></td>
    <td><center><img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/2.png" srcset="/img/loading.gif" lazyload alt="第二张图片显示不出时显示的文字" height="150">
                    <br>
        结果
                    </center></td>
    </tr>
</table>

<h3 id="获得连续点列"><a href="#获得连续点列" class="headerlink" title="获得连续点列"></a>获得连续点列</h3><h6 id="预先处理-1"><a href="#预先处理-1" class="headerlink" title="预先处理"></a>预先处理</h6><p>​        若在edge数组中一个点与其八邻域都被赋值为1，则将该点赋值为0。</p>
<h6 id="定义方向"><a href="#定义方向" class="headerlink" title="定义方向"></a>定义方向</h6><p>​        将一个中心点的八邻域中的左上角点的方向定义为1，顺时针依次定义1至8，如图：</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/direction.png" srcset="/img/loading.gif" lazyload alt="direction" style="zoom: 67%;">

<h6 id="检测点列算法"><a href="#检测点列算法" class="headerlink" title="检测点列算法"></a>检测点列算法</h6><p>​        检测时以上一检测的方向为基础，具体可分为一下几种情况：</p>
<p><strong>1、原方向上存在标记点，即点4</strong></p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case1.png" srcset="/img/loading.gif" lazyload alt="case1" style="zoom:50%;">

<p>​    <strong>2、原方向上不存在标记点，令上下左右方向的点优先级大于斜对点，取点2</strong></p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case2.png" srcset="/img/loading.gif" lazyload alt="case2" style="zoom:50%;">

<p>​    <strong>3、原方向上不存在标记点，原方向垂直方向上两边都有标记点，此种情况在已添加的点中向前搜索，找到从后往前出现的第一个与可能的两个方向相同的方向，如图则取点2而不取点6</strong></p>
<p>​                                          <img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/case3.png" srcset="/img/loading.gif" lazyload alt="case3" style="zoom:50%;">     </p>
<p>   <strong>4、若原方向上不存在标记点，并且只在斜对方向上有标记点，下一个方向直接返回原方向</strong></p>
<h6 id="遍历edge数组检测出所有连续的点列"><a href="#遍历edge数组检测出所有连续的点列" class="headerlink" title="遍历edge数组检测出所有连续的点列"></a>遍历edge数组检测出所有连续的点列</h6><p>​        为了避免遍历到的第一个点为一连续点列的中间点而不是端点，执行一下步骤：若第一个点的八邻域中在edge数组中只有一个点被赋值为1，那么认为它是一个连续点列的端点；若八邻域中有多个点被赋值为1，则默认一个方向为“4”，一个方向为“8”，分两条路进行检测，最后将一个点列转置后与另一个点列合并，得到一个完整的点列。</p>
<h3 id="直线检测"><a href="#直线检测" class="headerlink" title="直线检测"></a>直线检测</h3><p>​        以连续点列为基础，使用以下算法检测直线：</p>
<p>​        1、先取连续点列的前三个点为基础，得到一个基础方向向量（两个有顺序的方向对），然后在后面检测是否连续存在该方向向量。例如</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/detect1 (1).png" srcset="/img/loading.gif" lazyload alt="detect1 (1)" style="zoom:50%;">

<p>​        2、可以接受两个相同方向向量中有两个不同的方向，以上图例中两个相同的方向向量中存在一个其他的方向，即2。下图情况也是允许的：</p>
<p>​                                        <img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/detect2.png" srcset="/img/loading.gif" lazyload alt="detect2" style="zoom:50%;"></p>
<p>​        若一个符合要求的点的序列长度大于图像的长宽中最小值的三分之一（long lines），则认为该线段极有可能是证件的边缘点；若序列长度大于10(small lines)，则可能是证件边缘的一部分。</p>
<h3 id="短直线的拼接"><a href="#短直线的拼接" class="headerlink" title="短直线的拼接"></a>短直线的拼接</h3><p>​        对于两条短直线是否处于同一条直线的判断条件为：</p>
<p>​            1. 计算一条直线上所有点到另一条直距离的平均值，若平均值大于5，则否决</p>
<p>​            2.假设这两条线段可以拼接为一条线段，用两条线段上的所有点拟合一条新的直线，若两原线段上的点到新    直线距离小于1的都超过80%，则认为在同一条直线上。</p>
<p>​        </p>
<h3 id="寻找证件边缘直线"><a href="#寻找证件边缘直线" class="headerlink" title="寻找证件边缘直线"></a>寻找证件边缘直线</h3><p>​        对于以上所得直线，一部分是线段边缘直线，还有一部分不是线段边缘直线。</p>
<p>​        我们使用以下算法寻找证件边缘直线：</p>
<p>​            1、遍历所有直线，求出其余直线与该直线的交点，并将这些交点按在直线上从一端到另一端的顺序排序</p>
<p>​            2、对于相邻两交点，计算两交点长度中包含于原线段的比例，若大于50%，则保留。具体有一下几种情                        况：</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/intersactions.png" srcset="/img/loading.gif" lazyload alt="intersactions" style="zoom:67%;">

<p>​                            </p>
<p>​                                对于交点1,2，计算端点与交点2的距离与交点1，2的距离之比，若大于50%则保留；</p>
<p>​                                对于交点2,3,全在线段之中，保留；</p>
<p>​                                对于交点3,4，计算交点3与右边端点的距离与交点3， 4的距离比，若大于50%则保留；</p>
<p>​                                对于交点4,5，都在线段外，舍弃；</p>
<p>​                                若不存在交点2,3,4：两交点都在线段外，保留。</p>
<p>​            3、 将所有保留直线按顺序串联起来，最终得到四条边缘直线，并计算出四个交点。</p>
<p>​        对于交点1,2这样的情况，由于直线检测时可能会遗漏端点附近的几个像素，所以若计算所得比例少于50%，我们将再次计算最初的edge数组中被标记为1的点的距离与交点1,2距离的比例，若大于50%，则依然认为该线段是有效的。</p>
<p>对于所有有效的线段，进行一次剔除：</p>
<p>​    对于任一线段，若两个端点中任何一个没有其他线段与之连接，则舍弃。</p>
<p>​    重复以上操作，直到一次剔除操作没有剔除任何线段。</p>
<p>对被切分的线段重新拼接，根据三角形两边之和大于第三边的原理，对于两相邻的线段，若两线段长度之和减去两远端点的距离小于1，则认为两线段在同一直线上，然后将两线段合为一条线段。</p>
<p>合并完成后即得到证件在缩小后图像中的边缘直线，两两相交得到顶点。</p>
<h3 id="映射原图像"><a href="#映射原图像" class="headerlink" title="映射原图像"></a>映射原图像</h3><p>​        将顶点横纵坐标分别乘以缩小倍数，即可得到在大图中的顶点，由于缩小时像素的取法，映射回大图后顶点位置可能有缩小倍数个像素的误差，所以将顶点映射回大图后需要重新寻找证件边缘直线。</p>
<p>​        具体方法为： 对于任一由两相邻顶点形成的有误差的边，计算其直线方程，若其倾斜角度更接近竖直方向，则在疑似边上每点处水平方向上两边分别拓展缩小倍数个像素，在这2*缩小倍数个点中找出区分度最大点；若其倾斜角度更接近水平方向，则在边上每点竖直方向上两边分别拓展缩小倍数个像素，找出区分度的最大值点。</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/tz.png" srcset="/img/loading.gif" lazyload alt="tz" style="zoom:50%;">

<p>然后再这些区分度最大值点中找出“关键点”，进行最小二乘法直线拟合。</p>
<p>​        关键点：水平或者竖直方向连续点（至少两个）的首尾两个点，例如：</p>
<img src="/2022/02/24/20184403%E6%BD%98%E7%9B%B8%E4%BC%9A%2022.2/关键点.png" srcset="/img/loading.gif" lazyload alt="关键点" style="zoom:50%;">

<p>​                        红色标记点即为关键点。使用关键点拟合避免了噪声点参与拟合的情况，提高了准确率。</p>
<p>​        </p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%91%A8%E6%8A%A5/">周报</a>
                    
                  </div>
                
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/25/GNS3/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">GNS3</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/02/23/22.2.24/">
                        <span class="hidden-mobile">22.2.24</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
      <div class="col-lg-7 mx-auto nopadding-x-md">
        <div class="container custom mx-auto">
          <center> <span id="runtime_span", style="color:#000000"></span> </center> <script type="text/javascript">function show_runtime(){window.setTimeout("show_runtime()",1000);X=new  Date("2/2/2022 00:00:00"); Y=new Date();T=(Y.getTime()-X.getTime());M=24*60*60*1000; a=T/M;A=Math.floor(a);b=(a-A)*24;B=Math.floor(b);c=(b-B)*60;C=Math.floor((b-B)*60);D=Math.floor((c-C)*60); runtime_span.innerHTML="This site has survived: "+A+" days"+B+" hours"+C+" minuts"+D+" seconds"}show_runtime();</script> <center><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> <span id="busuanzi_container_site_pv">has been visited <span id="busuanzi_value_site_pv"></span> times</span></center>
        </div>
      </div>
    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>














  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/love.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
